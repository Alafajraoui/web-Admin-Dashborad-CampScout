"use client"
import React, { useEffect, useState } from "react";
import dynamic from "next/dynamic";
import ChartOne from "../Charts/ChartOne";
import ChartTwo from "../Charts/ChartTwo";
import ChatCard from "../Chat/ChatCard";
import TableOne from "../Tables/TableOne";
import CardDataStats from "../CardDataStats";

// Dynamic imports
const MapOne = dynamic(() => import("@/components/Maps/MapOne"), { ssr: false });
const ChartThree = dynamic(() => import("@/components/Charts/ChartThree"), { ssr: false });

// Fetch data function
const fetchDataDashboard = async () => {
  const response = await fetch("http://127.0.0.1:5000/api/dashboard/getAll");
  if (!response.ok) {
    throw new Error('Network response was not ok');
  }
  const data = await response.json();
  return data;
};

// ECommerce Component
const ECommerce: React.FC = () => {
  const [data, setData] = useState<{
    totalViews: number;
    totalCampingPosts: number;
    campingPosts: any[];
    totalUsers: number;
    totalExperiencesTips: number;
  } | null>(null);

  useEffect(() => {
    fetchDataDashboard()
      .then(fetchedData => setData(fetchedData))
      .catch(error => console.error("Error fetching dashboard data:", error));
  }, []);

  if (!data) {
    return <div>Loading...</div>;
  }

  return (
    <>
      <div className="grid grid-cols-1 gap-4 md:grid-cols-2 md:gap-6 xl:grid-cols-4 2xl:gap-7.5">
        <CardDataStats title="Total Views" total={data.totalViews}>
          <svg
            className="fill-primary dark:fill-white"
            width="22"
            height="16"
            viewBox="0 0 22 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M11 15.1156C4.19376 15.1156 0.825012 8.61876 0.687512 8.34376C0.584387 8.13751 0.584387 7.86251 0.687512 7.65626C0.825012 7.38126 4.19376 0.918762 11 0.918762C17.8063 0.918762 21.175 7.38126 21.3125 7.65626C21.4156 7.86251 21.4156 8.13751 21.3125 8.34376C21.175 8.61876 17.8063 15.1156 11 15.1156ZM2.26876 8.00001C3.02501 9.27189 5.98126 13.5688 11 13.5688C16.0188 13.5688 18.975 9.27189 19.7313 8.00001C18.975 6.72814 16.0188 2.43126 11 2.43126C5.98126 2.43126 3.02501 6.72814 2.26876 8.00001Z"
              fill=""
            />
            <path
              d="M11 10.9219C9.38438 10.9219 8.07812 9.61562 8.07812 8C8.07812 6.38438 9.38438 5.07812 11 5.07812C12.6156 5.07812 13.9219 6.38438 13.9219 8C13.9219 9.61562 12.6156 10.9219 11 10.9219ZM11 6.625C10.2437 6.625 9.625 7.24375 9.625 8C9.625 8.75625 10.2437 9.375 11 9.375C11.7563 9.375 12.375 8.75625 12.375 8C12.375 7.24375 11.7563 6.625 11 6.625Z"
              fill=""
            />
          </svg>
        </CardDataStats>
        <CardDataStats title="Total Camping Posts" total={data.totalCampingPosts}>
          <svg
            className="fill-primary dark:fill-white"
            width="20"
            height="22"
            viewBox="0 0 20 22"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M11.7531 16.4312C10.3781 16.4312 9.27808 17.5312 9.27808 18.9062C9.27808 20.2812 10.3781 21.3812 11.7531 21.3812C13.1281 21.3812 14.2281 20.2812 14.2281 18.9062C14.2281 17.5656 13.0937 16.4312 11.7531 16.4312ZM11.7531 19.8687C11.2375 19.8687 10.825 19.4562 10.825 18.9406C10.825 18.425 11.2375 18.0125 11.7531 18.0125C12.2687 18.0125 12.6812 18.425 12.6812 18.9406C12.6812 19.4219 12.2343 19.8687 11.7531 19.8687Z"
              fill=""
            />
            <path
              d="M5.22183 16.4312C3.84683 16.4312 2.74683 17.5312 2.74683 18.9062C2.74683 20.2812 3.84683 21.3812 5.22183 21.3812C6.59683 21.3812 7.69683 20.2812 7.69683 18.9062C7.69683 17.5656 6.56245 16.4312 5.22183 16.4312ZM5.22183 19.8687C4.7062 19.8687 4.2937 19.4562 4.2937 18.9406C4.2937 18.425 4.7062 18.0125 5.22183 18.0125C5.73745 18.0125 6.14995 18.425 6.14995 18.9406C6.14995 19.4219 5.73745 19.8687 5.22183 19.8687Z"
              fill=""
            />
            <path
              d="M19.0062 0.618744H17.15C16.325 0.618744 15.6031 1.23749 15.5 2.06249L14.95 6.01562H1.37185C1.0281 6.01562 0.684353 6.18749 0.443728 6.46249C0.237478 6.73749 0.134353 7.11562 0.237478 7.45937C0.237478 7.49374 0.237478 7.49374 0.237478 7.52812L2.36873 13.9562C2.50623 14.4375 2.9531 14.7812 3.46873 14.7812H12.9562C14.2281 14.7812 15.3281 13.8187 15.5 12.5469L16.9437 2.26874C16.9437 2.19999 17.0125 2.16562 17.0812 2.16562H18.9375C19.35 2.16562 19.7281 1.82187 19.7281 1.37499C19.7281 0.928119 19.4187 0.618744 19.0062 0.618744ZM14.0219 12.5469C13.8875 13.4609 13.0562 14.0937 12.0406 14.0937H3.42185C3.59373 13.1125 4.00623 12.2625 4.6125 11.5625L10.9469 7.52625L11.075 7.40125L11.075 7.30125L13.9019 3.27625L13.5969 12.5469H14.0219ZM18.4875 1.37499H17.0812C17.0562 1.37499 17.0188 1.33749 16.9937 1.30937L16.975 1.36874L16.9187 1.52812L14.425 7.18125L14.2812 7.38125C14.2812 7.38437 14.2625 7.41562 14.2625 7.41562L15.3469 2.63749C15.3781 2.43749 15.5406 2.26562 15.755 2.26562H17.4937C17.5687 2.26562 17.6469 2.32625 17.6687 2.40125C17.7062 2.53974 17.4937 2.75937 17.3625 2.95312L17.215 3.025C17.1343 3.05937 17.1169 3.07062 17.0919 3.0625C16.9769 2.99375 16.9156 2.92188 16.9437 2.84562L16.9499 2.82375L16.9437 2.82187L17.2875 2.75937C17.6212 2.75937 17.6437 2.63749 17.6781 2.54374C17.7469 2.27812 17.875 2.31812 18.0625 2.20374C18.1719 2.11999 18.2269 2.04749 18.2375 1.96874C18.2875 1.75937 18.5125 1.37499 18.4875 1.37499Z"
              fill=""
            />
          </svg>
        </CardDataStats>
        <CardDataStats title="Total Experiences Tips" total={data.totalExperiencesTips}>
          <svg
            className="fill-primary dark:fill-white"
            width="24"
            height="22"
            viewBox="0 0 24 22"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M20.7375 8.89999L13.7375 1.74999C13.3687 1.38749 12.7437 1.21874 12.3063 1.435 12.0599 1.555 11.8287 1.7775 11.7125 2.07125L8.55994 7.40125L6.86245 9.29999L6.86245 9.29999C6.67188 9.55499 6.71245 9.82374 6.88125 10.0237L6.91875 10.0287C7.1125 10.23 7.375 10.2125 7.54688 10.0863L7.54994 10.0787L9.54875 8.30625L11.6188 5.42125L12.275 6.13625C12.1125 6.32874 12.0306 6.63749 12.0156 6.93749C12.0156 6.93749 12.0188 6.95249 12.0281 6.96562L10.825 9.55625L10.5519 10.3175L10.375 10.4344C10.2375 10.5219 10.0794 10.5499 9.92188 10.6719L9.05994 11.7999L5.70312 15.4187L4.87188 16.3437L5.33438 16.6719L12.5 13.5763C12.9499 13.2806 13.1156 12.755 13.0375 12.2375C13.1188 12.2644 13.2106 12.2437 13.2787 12.1563C13.375 12.0344 13.3794 11.8444 13.2937 11.6787L11.6188 9.55625L12.2156 7.86999L14.4469 5.57187L16.9656 6.23749L20.7375 8.89999Z"
              fill=""
            />
            <path
              d="M13.275 17.2075C12.8012 17.2075 12.4469 17.5619 12.4469 18.0363C12.4469 18.5106 12.8012 18.865 13.275 18.865C13.7487 18.865 14.1031 18.5106 14.1031 18.0363C14.1031 17.5619 13.7487 17.2075 13.275 17.2075Z"
              fill=""
            />
            <path
              d="M19.8531 17.2075C19.3781 17.2075 19.0237 17.5619 19.0237 18.0363C19.0237 18.5106 19.3781 18.865 19.8531 18.865C20.3275 18.865 20.6812 18.5106 20.6812 18.0363C20.6812 17.5619 20.3275 17.2075 19.8531 17.2075Z"
              fill=""
            />
            <path
              d="M20.2625 7.275L20.7469 8.11625C20.7675 8.16062 20.8812 8.30812 20.7469 8.39188C20.7125 8.43437 20.5156 8.60562 20.4856 8.64375L20.4375 8.6875L18.6031 8.80562L14.0156 7.79688L12.8937 7.4625L12.8313 7.48999L10.6844 9.7925L8.185 12.0425L7.715 12.3163L5.26406 14.4706L5.26406 14.4706C5.12656 14.6063 5.085 14.7625 5.16875 14.8875L9.54875 18.2437L14.5594 22.5187L15.625 22.8812L17.6219 22.0463L22.5687 17.7237C22.6375 17.6575 22.5987 17.4575 22.6219 17.4237C22.6375 17.3687 22.7456 17.2537 22.7456 17.2537L23.4906 16.6287L23.4969 16.6237L23.5844 16.5956L20.2625 13.1344L20.2625 13.1344C20.2125 13.0306 20.1437 12.9275 20.1469 12.8387C20.1469 12.8387 20.1687 12.8512 20.175 12.8556L23.2794 11.4781L23.9687 10.8625L21.7856 9.56062L19.7656 8.85062C19.7519 8.82562 19.7769 8.9125 19.7794 8.92312C19.7919 8.92499 19.8356 8.8625 19.8531 8.85062C19.9344 8.82562 20.2219 8.54687 20.2387 8.54687C20.2512 8.53187 20.3175 8.48999 20.2625 8.4375L20.2625 7.275Z"
              fill=""
            />
          </svg>
        </CardDataStats>
        <CardDataStats title="Total Users" total={data.totalUsers}>
          <svg
            className="fill-primary dark:fill-white"
            width="24"
            height="22"
            viewBox="0 0 24 22"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 11.5469C7.50625 11.5469 4.08938 15.2469 2.61875 18.3356C1.7925 19.5156 1.18125 21.1281 1.18125 22.5938C1.18125 22.7106 1.2125 22.825 1.275 22.9281C1.45375 23.3531 2.0475 23.3912 2.4825 23.2775C6.81875 21.7519 9.64625 16.5719 9.64625 11.5469C9.64625 6.18562 12.745 1.98937 17.4469 0.72875C17.6725 0.61875 17.9606 0.61875 18.1944 0.72875C22.8938 1.98937 25.9925 6.18562 25.9925 11.5469C25.9925 16.5719 28.8212 21.7519 33.1588 23.2775C33.5944 23.3912 34.1881 23.3531 34.3688 22.9281C34.4313 22.825 34.4625 22.7106 34.4625 22.5938C34.4625 21.1281 33.8525 19.5156 33.0294 18.3356C31.5594 15.2469 28.1425 11.5469 23.6481 11.5469C21.1812 11.5469 18.2725 12.9406 16.8438 15.8206L16.4588 16.3356L15.4244 16.1687C14.6494 16.0144 13.8256 16.0719 13.1444 16.2531L13.2156 16.3144C11.8125 16.4512 10.4144 16.7825 9.20375 17.3206L7.70875 18.0444L5.92625 18.3944L5.01875 17.595L4.1375 17.7981L4.27938 17.3875L4.82375 16.6912C4.98063 16.4175 5.15938 16.1719 5.38188 15.9612C7.07938 14.4387 8.875 13.3362 10.7675 12.7387L11.3156 12.4462L11.2269 12.3694L11.3375 12.2194C12.2856 11.3562 12.4825 10.5181 12 10.5181C12 11.5469 12 11.5469 12 11.5469ZM22.9687 1.68999C19.0975 3.23875 15.9187 7.89625 14.2831 12.7937C13.7263 13.7094 13.0712 14.7537 12.3094 15.7594C12.0375 16.0194 11.6288 16.2356 11.3281 16.3356C11.025 16.4331 10.7344 16.2125 10.5512 15.9787L10.4512 15.8462C9.82188 15.2156 9.51875 14.4312 9.32938 13.5156L9.2625 13.2219C8.515 12.9206 7.7025 12.7075 6.865 12.5694C6.12625 12.4275 5.37188 12.295 4.59375 12.0937C4.52812 12.1862 4.42812 12.2725 4.31875 12.3625L2.6275 13.7375L2.64688 13.8206C4.2375 15.0512 5.6225 16.0712 6.76875 17.1937L7.08375 17.7019L7.48062 18.2025L8.68625 18.9406L11.9781 21.4344C14.3187 23.095 16.6031 24.1156 18.5156 24.1156C21.3488 24.1156 23.4794 22.5037 23.7225 21.3325C23.8225 21.155 23.8019 20.9656 23.7706 20.8594C23.7281 20.5806 23.6931 20.3094 23.6931 20.0375C23.6931 19.4181 23.425 18.8375 23.025 18.4844C21.9719 17.225 21.6975 15.9512 21.7512 14.5625C21.8975 10.5562 20.7438 6.31875 18.4844 2.51562L16.6588 1.1925L22.9687 1.68999Z"
              fill=""
            />
          </svg>
        </CardDataStats>
      </div>

      <div className="mt-4 grid grid-cols-12 gap-4 md:mt-6 md:gap-6 2xl:mt-7.5 2xl:gap-7.5">
        <ChartOne />
        <ChartTwo />
        <ChartThree />
        <MapOne />
      </div>

    </>
  );
};

export default ECommerce;

